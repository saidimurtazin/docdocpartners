/**
 * Self-Employment Verification Service
 * Проверка статуса самозанятого через API ФНС
 */

export interface SelfEmploymentCheckResult {
  isValid: boolean;
  inn: string;
  fullName?: string;
  registrationDate?: string;
  status?: string;
  error?: string;
}

/**
 * Проверить формат ИНН (без автоматической проверки в ФНС)
 * 
 * Проверка статуса самозанятого производится вручную администратором
 * через сайт: https://npd.nalog.ru/check-status/
 * 
 * Эта функция только валидирует формат ИНН
 */
export async function checkSelfEmploymentStatus(inn: string): Promise<SelfEmploymentCheckResult> {
  // Валидация ИНН (должен быть 10 или 12 цифр)
  if (!/^\d{10}$|^\d{12}$/.test(inn)) {
    return {
      isValid: false,
      inn,
      error: "Неверный формат ИНН. Должно быть 10 или 12 цифр.",
    };
  }

  // Формат корректный - статус проверяется администратором вручную
  return {
    isValid: true,
    inn,
    status: "pending_verification",
  };
}

/**
 * Инструкция как стать самозанятым
 */
export const SELF_EMPLOYMENT_GUIDE = `
## Как стать самозанятым

### Преимущества для агентов DocDocPartner:
- ✅ Вы получаете **полную сумму вознаграждения** (7% или 10%)
- ✅ Налог всего **6%** (платите сами через приложение "Мой налог")
- ✅ Не нужно платить соц. отчисления (~30%)
- ✅ Простая регистрация за 10 минут

### Как зарегистрироваться:

**Шаг 1:** Скачайте приложение "Мой налог"
- iOS: https://apps.apple.com/ru/app/мой-налог/id1437518854
- Android: https://play.google.com/store/apps/details?id=com.gnivts.selfemployed

**Шаг 2:** Пройдите регистрацию
- Отсканируйте паспорт
- Сделайте селфи для подтверждения личности
- Укажите регион работы

**Шаг 3:** Получите ИНН
- Если у вас уже есть ИНН - введите его
- Если нет - система автоматически создаст

**Шаг 4:** Добавьте ИНН в профиль DocDocPartner
- Откройте бот @maruspartnersbot
- Перейдите в "Профиль" → "Реквизиты"
- Укажите ваш ИНН

### Важно:
- Лимит дохода самозанятого: **2,4 млн ₽ в год**
- Налог платится **автоматически** через приложение
- Отчетность **не требуется** - все делает приложение

### Нужна помощь?
Напишите в поддержку: @marus_support
`;
